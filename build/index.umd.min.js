!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).ReactSlotEngine={},e.React)}(this,function(e,t){"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=n(t),o=function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},o.apply(this,arguments)};function u(e,t,n){if(n||2===arguments.length)for(var r,o=0,u=t.length;o<u;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}"function"==typeof SuppressedError&&SuppressedError;var i=0;function a(e){var t=new Map,n=new Map,r=new Map;function o(e){var t;null===(t=n.get(e))||void 0===t||t.forEach(function(e){return e()})}return{parent:e,register:function(e,n,a){var l,c,f={id:++i,render:n,priority:null!==(l=null==a?void 0:a.priority)&&void 0!==l?l:0,async:null==a?void 0:a.async},s=u(u([],null!==(c=t.get(e))&&void 0!==c?c:[],!0),[f],!1);return s.sort(function(e,t){return t.priority-e.priority}),t.set(e,s),r.set(e,s),o(e),function(){var n,u=(null!==(n=t.get(e))&&void 0!==n?n:[]).filter(function(e){return e.id!==f.id});u.length?(t.set(e,u),r.set(e,u)):(t.delete(e),r.delete(e)),o(e)}},get:function(t){var n,o;return null!==(o=null!==(n=r.get(t))&&void 0!==n?n:null==e?void 0:e.get(t))&&void 0!==o?o:[]},subscribe:function(r,o){var u,i=null!==(u=n.get(r))&&void 0!==u?u:new Set;i.add(o),n.set(r,i);var a=t.has(r)||null==e?void 0:e.subscribe(r,o);return function(){i.delete(o),0===i.size&&n.delete(r),null==a||a()}}}}var l=r.default.createContext(null);function c(){var e=r.default.useContext(l);if(!e)throw new Error("SlotEngine missing. Wrap your app with <SlotProvider>.");return e}function f(e){var t={exports:{}};return e(t,t.exports),t.exports}var s="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},d=r.default.useState,p=r.default.useEffect,v=r.default.useLayoutEffect,g=r.default.useDebugValue;function E(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!s(e,n)}catch(e){return!0}}var y="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),r=d({inst:{value:n,getSnapshot:t}}),o=r[0].inst,u=r[1];return v(function(){o.value=n,o.getSnapshot=t,E(o)&&u({inst:o})},[e,n,t]),p(function(){return E(o)&&u({inst:o}),e(function(){E(o)&&u({inst:o})})},[e]),g(n),n},S={useSyncExternalStore:void 0!==r.default.useSyncExternalStore?r.default.useSyncExternalStore:y},_=f(function(e,t){"production"!==process.env.NODE_ENV&&function(){function e(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!o(e,n)}catch(e){return!0}}"undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(Error());var n=r.default,o="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},u=n.useState,i=n.useEffect,a=n.useLayoutEffect,l=n.useDebugValue,c=!1,f=!1,s="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(t,r){c||void 0===n.startTransition||(c=!0,console.error("You are using an outdated, pre-release alpha of React 18 that does not support useSyncExternalStore. The use-sync-external-store shim will not work correctly. Upgrade to a newer pre-release."));var s=r();if(!f){var d=r();o(s,d)||(console.error("The result of getSnapshot should be cached to avoid an infinite loop"),f=!0)}var p=(d=u({inst:{value:s,getSnapshot:r}}))[0].inst,v=d[1];return a(function(){p.value=s,p.getSnapshot=r,e(p)&&v({inst:p})},[t,s,r]),i(function(){return e(p)&&v({inst:p}),t(function(){e(p)&&v({inst:p})})},[t]),l(s),s};t.useSyncExternalStore=void 0!==n.useSyncExternalStore?n.useSyncExternalStore:s,"undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(Error())}()}),O=f(function(e){"production"===process.env.NODE_ENV?e.exports=S:e.exports=_});e.Slot=function(e){var n=e.name,u=e.fallback,i=void 0===u?null:u,a=e.loadingFallback,l=void 0===a?null:a,f=e.mode,s=void 0===f?"first":f,d=e.props,p=c(),v=t.useCallback(function(e){return p.subscribe(n,e)},[p,n]),g=O.useSyncExternalStore(v,function(){var e=p.get(n);return e&&e.length?e:[]},function(){return[]});if(!g.length)return r.default.createElement(r.default.Fragment,null,i);var E=function(e){var n=e.render,u=r.default.createElement(n,o({},d));return e.async?r.default.createElement(t.Suspense,{fallback:l,key:e.id},u):r.default.createElement(r.default.Fragment,{key:e.id},u)};return r.default.createElement(r.default.Fragment,null,"all"===s?g.map(E):E(g[0]))},e.SlotProvider=function(e){var t=e.engine,n=e.children,o=r.default.useContext(l),u=r.default.useRef(null);return u.current||(u.current=null!=t?t:a(null!=o?o:void 0)),r.default.createElement(l.Provider,{value:u.current},n)},e.applySlotPlugins=function(e,t){void 0===t&&(t=[]);var n=[];return t.forEach(function(t){try{var r=t.setup(e);"function"==typeof r&&n.push(r)}catch(e){"production"!==process.env.NODE_ENV&&console.error("[SlotPlugin:".concat(t.name,"] setup failed"),e)}}),function(){n.forEach(function(e){return e()})}},e.createSlotEngine=a,e.useSlotEngine=function(){var e=c();return{engine:e,register:e.register,get:e.get}},e.useSlotEngineContext=c,Object.defineProperty(e,"__esModule",{value:!0})});
