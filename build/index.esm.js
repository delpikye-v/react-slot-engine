import e,{useCallback as n,Suspense as t}from"react";var r=function(){return r=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e},r.apply(this,arguments)};function o(e,n,t){if(t||2===arguments.length)for(var r,o=0,u=n.length;o<u;o++)!r&&o in n||(r||(r=Array.prototype.slice.call(n,0,o)),r[o]=n[o]);return e.concat(r||Array.prototype.slice.call(n))}"function"==typeof SuppressedError&&SuppressedError;var u=0;function i(e){var n=new Map,t=new Map;function r(e){var n;null===(n=t.get(e))||void 0===n||n.forEach(function(e){return e()})}return{parent:e,register:function(e,t,i){var a,c,l={id:++u,render:t,priority:null!==(a=null==i?void 0:i.priority)&&void 0!==a?a:0,async:null==i?void 0:i.async},s=o(o([],null!==(c=n.get(e))&&void 0!==c?c:[],!0),[l],!1);return s.sort(function(e,n){return n.priority-e.priority}),n.set(e,s),r(e),function(){var t,o=(null!==(t=n.get(e))&&void 0!==t?t:[]).filter(function(e){return e.id!==l.id});o.length?n.set(e,o):n.delete(e),r(e)}},get:function(t){var r,u=null!==(r=function(e){return n.get(e)}(t))&&void 0!==r?r:null==e?void 0:e.get(t);return u?o([],u,!0):u},subscribe:function(r,o){var u,i=null!==(u=t.get(r))&&void 0!==u?u:new Set;i.add(o),t.set(r,i);var a=n.has(r)||null==e?void 0:e.subscribe(r,o);return function(){i.delete(o),0===i.size&&t.delete(r),null==a||a()}}}}var a=e.createContext(null);function c(n){var t=n.engine,r=n.children,o=e.useContext(a),u=e.useRef(null);return u.current||(u.current=null!=t?t:i(null!=o?o:void 0)),e.createElement(a.Provider,{value:u.current},r)}function l(){var n=e.useContext(a);if(!n)throw new Error("SlotEngine missing. Wrap your app with <SlotProvider>.");return n}function s(e){var n={exports:{}};return e(n,n.exports),n.exports}var f="function"==typeof Object.is?Object.is:function(e,n){return e===n&&(0!==e||1/e==1/n)||e!=e&&n!=n},d=e.useState,p=e.useEffect,v=e.useLayoutEffect,E=e.useDebugValue;function _(e){var n=e.getSnapshot;e=e.value;try{var t=n();return!f(e,t)}catch(e){return!0}}var g="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,n){return n()}:function(e,n){var t=n(),r=d({inst:{value:t,getSnapshot:n}}),o=r[0].inst,u=r[1];return v(function(){o.value=t,o.getSnapshot=n,_(o)&&u({inst:o})},[e,t,n]),p(function(){return _(o)&&u({inst:o}),e(function(){_(o)&&u({inst:o})})},[e]),E(t),t},y={useSyncExternalStore:void 0!==e.useSyncExternalStore?e.useSyncExternalStore:g},S=s(function(n,t){"production"!==process.env.NODE_ENV&&function(){function n(e){var n=e.getSnapshot;e=e.value;try{var t=n();return!o(e,t)}catch(e){return!0}}"undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(Error());var r=e,o="function"==typeof Object.is?Object.is:function(e,n){return e===n&&(0!==e||1/e==1/n)||e!=e&&n!=n},u=r.useState,i=r.useEffect,a=r.useLayoutEffect,c=r.useDebugValue,l=!1,s=!1,f="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,n){return n()}:function(e,t){l||void 0===r.startTransition||(l=!0,console.error("You are using an outdated, pre-release alpha of React 18 that does not support useSyncExternalStore. The use-sync-external-store shim will not work correctly. Upgrade to a newer pre-release."));var f=t();if(!s){var d=t();o(f,d)||(console.error("The result of getSnapshot should be cached to avoid an infinite loop"),s=!0)}var p=(d=u({inst:{value:f,getSnapshot:t}}))[0].inst,v=d[1];return a(function(){p.value=f,p.getSnapshot=t,n(p)&&v({inst:p})},[e,f,t]),i(function(){return n(p)&&v({inst:p}),e(function(){n(p)&&v({inst:p})})},[e]),c(f),f};t.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:f,"undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(Error())}()}),O=s(function(e){"production"===process.env.NODE_ENV?e.exports=y:e.exports=S});function h(o){var u=o.name,i=o.fallback,a=void 0===i?null:i,c=o.loadingFallback,s=void 0===c?null:c,f=o.mode,d=void 0===f?"first":f,p=o.props,v=l(),E=n(function(e){return v.subscribe(u,e)},[v,u]),_=O.useSyncExternalStore(E,function(){return v.get(u)},function(){return[]});if(!_.length)return e.createElement(e.Fragment,null,a);var g=function(n){var o=n.render,u=e.createElement(o,r({},p));return n.async?e.createElement(t,{fallback:s,key:n.id},u):e.createElement(e.Fragment,{key:n.id},u)};return e.createElement(e.Fragment,null,"all"===d?_.map(g):g(_[0]))}function m(){var e=l();return{engine:e,register:e.register,get:e.get}}function w(e,n){void 0===n&&(n=[]);var t=[];return n.forEach(function(n){try{var r=n.setup(e);"function"==typeof r&&t.push(r)}catch(e){"production"!==process.env.NODE_ENV&&console.error("[SlotPlugin:".concat(n.name,"] setup failed"),e)}}),function(){t.forEach(function(e){return e()})}}export{h as Slot,c as SlotProvider,w as applySlotPlugins,i as createSlotEngine,m as useSlotEngine};
